SELECT
    a.INSTANCE_ID,
    a.MODULE AS application,
    a.PROGRAM AS backend_app,
    a.SQL_OPNAME AS sql_op,
    TO_CHAR(a.FIRST_LOAD_TIME, 'YYYY-MM-DD HH24:MI:SS') AS start_time,
    TO_CHAR(a.LAST_LOAD_TIME, 'YYYY-MM-DD HH24:MI:SS') AS end_time,
    ROUND((a.LAST_LOAD_TIME - a.FIRST_LOAD_TIME) * 24 * 60, 2) AS duration_minutes,
    h.MACHINE AS node
FROM
    GV$ACTIVE_SESSION_HISTORY a
JOIN
    DBA_HIST_ACTIVE_SESS_HISTORY h ON a.SQL_ID = h.SQL_ID
WHERE
    a.LAST_LOAD_TIME > SYSDATE - INTERVAL '30' MINUTE -- Adjust the time threshold as needed
ORDER BY
    a.LAST_LOAD_TIME DESC;
