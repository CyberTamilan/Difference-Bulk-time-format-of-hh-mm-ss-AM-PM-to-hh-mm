SELECT
    v.SQL_ID,
    s.FIRST_LOAD_TIME AS START_TIME,
    s.LAST_LOAD_TIME AS END_TIME,
    ROUND((s.LAST_LOAD_TIME - s.FIRST_LOAD_TIME) * 24 * 60, 2) AS duration_minutes,
    s.INST_ID AS INSTANCE_ID,
    s.MODULE AS application,
    s.PROGRAM AS backend_app,
    s.OPERATION AS sql_op,
    h.MACHINE AS node
FROM
    V$SQL s
JOIN
    DBA_HIST_ACTIVE_SESS_HISTORY h ON s.SQL_ID = h.SQL_ID
WHERE
    s.FIRST_LOAD_TIME IS NOT NULL
    AND s.LAST_LOAD_TIME IS NOT NULL
    AND s.LAST_LOAD_TIME > SYSDATE - INTERVAL '30' MINUTE -- Adjust the time threshold as needed
ORDER BY
    s.LAST_LOAD_TIME DESC;
